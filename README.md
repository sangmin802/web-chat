## ğŸ‘ web-socket

- socket.io
- React.js
- node.js
- gh-pages
- heroku

## ğŸ server express + socket.io

- [web-chat-server](https://github.com/sangmin802/web-chat-server)

## ğŸ– socket.io ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ê°¯ìˆ˜

### ğŸ» 2ê°œ

1. `/loby`
2. `/rooms`

### ğŸº 1ê°œ

1. `/chat`

- ë³¸ë˜ëŠ” ë‘ê°œì˜ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë¡œ `loby`ì™€ `rooms` ì˜ `socket.io` ì„œë²„ë¥¼ êµ¬ë¶„í•  ê¹Œ í•˜ë‹¤ê°€, ê·¸ëƒ¥ í•˜ë‚˜ì˜ ì„œë²„ë¥¼ ì‚¬ìš©í•˜ê³  `loby` ì»´í¬ë„ŒíŠ¸ ì–¸ë§ˆìš´íŠ¸ì‹œ, ì „ì²´ì±„íŒ… ì´ë²¤íŠ¸ì— ëŒ€í•œ ì—°ê²°ì„ ì·¨ì†Œí•˜ê³ , ê·“ì†ë§ì„ ìœ„í•œ `userID room`ì„ `leave` í•˜ëŠ”ê²Œ ë” ë‚˜ì„ë“¯ í•¨.

## ğŸ“ êµ¬ì¡°

- ğŸ”´ : ì„œë²„
- ğŸ”µ : í´ë¼ì´ì–¸íŠ¸

### ğŸ­ log-in

- ì‚¬ìš©ìì˜ ì•„ì´ë””ë¥¼ ì§€ì •í•˜ëŠ” ì»´í¬ë„ŒíŠ¸

### ğŸ¥ loby

- ìœ ì €ë¦¬ìŠ¤íŠ¸, ë°©ë¦¬ìŠ¤íŠ¸, ì „ì²´ì±„íŒ…Â·ê·“ì†ë§ ë‚´ìš© ì¶œë ¥
- ëª¨ë“  ìœ ì €ì™€ ì „ì²´ì±„íŒ…ì„ í•˜ëŠ” ì»´í¬ë„ŒíŠ¸
- íŠ¹ì • ìœ ì €ì™€ ê·“ì†ë§ì„ í•  ìˆ˜ ìˆëŠ” ì»´í¬ë„ŒíŠ¸
  > ë©”ì‹œì§€ ë‚´ìš©ì„ ë™ì¼í•œ `view`ì— ë…¸ì¶œì‹œí‚¤ì§€ë§Œ, ìƒ‰ìƒì„ ë‹¤ë¥´ê²Œ
- ê¸°ë³¸ `/`ì˜ `socket.io` ì„œë²„ê°€ ì•„ë‹Œ ì»¤ìŠ¤í…€ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ `/loby`ë¥¼ ì‚¬ìš©í•˜ì—¬ ì„œë²„ë¥¼ ìƒì„±í•˜ë„ë¡ í•¨.
- ì»´í¬ë„ŒíŠ¸ ì–¸ë§ˆìš´íŠ¸ ì‹œ í•´ë‹¹ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì˜ ì„œë²„ëŠ” ì¢…ë£Œì‹œì¼œì„œ ìƒˆë¡œìš´ ë©”ì‹œì§€ ì•ŒëŒì„ ë°›ì§€ ì•Šë„ë¡ í•¨
- `/loby` ì„œë²„ì—ì„œëŠ” ì‚¬ìš©ìì˜ `userID`ë¥¼ `room`ìœ¼ë¡œ ìƒì„±í•˜ì—¬ ì›í•˜ëŠ” `userID`ì—ê²Œë§Œ ë©”ì‹œì§€ë¥¼ ì „ë‹¬í•  ìˆ˜ ìˆë„ë¡ í•¨
  > `io.of('/loby').to(userID).emit`?
- ì „ì²´ì±„íŒ…ì˜ ê²½ìš° ëª¨ë“  ì‚¬ìš©ìê°€ ë³¼ ìˆ˜ ìˆë„ë¡ ë©”ì‹œì§€ ì „ë‹¬
  > `io.of('/loby').emit`?
- `loby` ì»´í¬ë„ŒíŠ¸ ë§ˆìš´íŠ¸ ì‹œ, í•´ë‹¹ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì˜ ì„œë²„ì— ì ‘ì†í•œ ëª¨ë“  ìœ ì € ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë°›ì•„ì™€ ì¢Œì¸¡ì— ì¶œë ¥
- `loby` ì»´í¬ë„ŒíŠ¸ ë§ˆìš´íŠ¸ ì‹œ, `socket.io`ì˜ `/rooms` ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ì„œë²„ì— ë“±ë¡ëœ ëª¨ë“  `room`ë“¤ì„ ë°›ì•„ì™€ ìš°ì¸¡ ìƒë‹¨ì— ì¶œë ¥
  > ë‚´ê°€ ì°¸ì—¬ì¤‘ì¸ ë°©ê³¼, ê°œì„¤ëœ ë°© êµ¬ë¶„
- ì°¸ì—¬ì¤‘ì¸ ë°©ì˜ ê²½ìš°, ìƒˆë¡œìš´ ë©”ì‹œì§€ ìˆ˜ì‹  ì‹œ ìƒˆë¡œìš´ ë©”ì‹œì§€ ê°¯ìˆ˜ ë…¸ì¶œ
  > ì¹´ì¹´ì˜¤í†¡ì²˜ëŸ¼
- ìƒì„±ë˜ì–´ìˆëŠ” `room` í´ë¦­ ì‹œ, `/rooms` ì˜ roomì— `join`
  > `socket.join(room)`?

### ğŸ¥¯ room

- [x] ğŸ”µ ë°© ìƒì„±ì„ ìœ„í•´ `room` ìƒì„± ë²„íŠ¼ í´ë¦­

  - [x] ğŸ”µ `roomName` ì†ì„± ì§€ì • í›„ ì„œë²„ì˜ `craete room` ì´ë²¤íŠ¸ í˜¸ì¶œ
    > êµ¬í˜„ì— ìˆì–´ì„œëŠ” ì¼ë‹¨ `roomID`ë¡œ `roomName` ëŒ€ì²´

- [x] ğŸ”´ `craete room` ìˆ˜ì‹ 

  - [x] ğŸ”´ `room store class`ì— `room` ì •ë³´ ì¶”ê°€
  - [x] ğŸ”´ ëª¨ë“  ìœ ì €ì—ê²Œ ìƒì„±ëœ `room` ì •ë³´ ì „ë‹¬ì„ ìœ„í•œ `room created` í˜¸ì¶œ

```ts
// ëŒ€ëµì ì¸ room êµ¬ì¡°
// í´ë¼ì´ì–¸íŠ¸ì—ì„œ roomsëŠ” new Mapìœ¼ë¡œ ê´€ë¦¬
interface room {
  creater: string;
  isJoined: boolean = false;
  roomID: string;
  roomName: string;
  users: { userName: string; userID: string }[];
  messages: { content: string; from: string }[];
  hasNewMessages: 0;
}
```

- [x] ğŸ”µ `room created` ìˆ˜ì‹ 

  - [x] ğŸ”µ `room.creater`ê°€ `socket.userID`ì™€ ë™ì¼í•˜ë©´ `join room` ë°”ë¡œ í˜¸ì¶œ
  - [x] ğŸ”µ `rooms` ìƒíƒœê°’ì— í•´ë‹¹ `room` ì •ë³´ ì¶”ê°€

- [x] ğŸ”µ ë°©ì— ë“¤ì–´ê°€ê¸° ìœ„í•´ `join room` í˜¸ì¶œ

  - [x] ğŸ”µ ë§Œì•½ ì´ë¯¸ ì°¸ì—¬í•´ì„œ `isJoined : true` ë¼ë©´ `room-loby` ì»´í¬ë„ŒíŠ¸ë§Œ í™œì„±í™”
  - [x] ğŸ”µ `isJoined : false` ë¼ë©´ `join room socket event emit`

- [x] ğŸ”´ `join room` ìˆ˜ì‹ 

  - [x] ğŸ”´ í˜¸ì¶œí•œ `socket.userID`ëŠ” `socket.join(roomID)`ë¡œ ì°¸ê°€
  - [x] ğŸ”´ `room store`ì— í•´ë‹¹ `roomID`ì˜ `users`ì— í•´ë‹¹ `socket` ìœ ì € ì •ë³´ ì¶”ê°€
  - [x] ğŸ”´ ì¶”ê°€ëœ í´ë¼ì´ì–¸íŠ¸ ì •ë³´ ì „ë‹¬. `join room` í˜¸ì¶œ
  - [x] ğŸ”´ í•´ë‹¹ `roomID`ì— ê°€ì…í•œ ìœ ì €ë“¤ì—ê²Œë§Œ `.to('roomID').emit`ìœ¼ë¡œ ì…ì¥ ë©”ì‹œì§€ ì•Œë¦¼ `room message`

- [x] ğŸ”µ `join room` ìˆ˜ì‹ 

  - [x] ğŸ”µ `room`ì— ì ‘ì†í•œ `userID`ê°€ `socket.userID`ì™€ ë™ì¼, ì¦‰ ë‚˜ ì´ê³ , `isJoined : false`ìƒíƒœë¼ë©´ `isJoined : true`ë¡œ ë³€ê²½
  - [x] ğŸ”µ `room`ì— ì ‘ì†í•œ `userID`ê°€ `socket.userID`ì™€ ë™ì¼, ì¦‰ ë‚˜ë¼ë©´ `room-loby` ì»´í¬ë„ŒíŠ¸ í™œì„±í™”
  - [x] ğŸ”µ `rooms` ìƒíƒœê°’ì— í•´ë‹¹ `room` ì •ë³´ ì¶”ê°€

- [x] ğŸ”µ ë°© ë‚˜ê°€ê¸°.

  - [x] ğŸ”µ ë°© `join` ìƒíƒœëŠ” ìœ ì§€í•˜ë©°, ë¡œë¹„ë¡œë§Œ ì´ë™í•  ê²½ìš° `setRoom(null)`
  - [x] ğŸ”µ ë°© `join` ìƒíƒœ ìì²´ë¥¼ í•´ì§€í•  ê²½ìš°, `roomID`ë¥¼ `leave rom` ì´ë²¤íŠ¸ë¡œ `emit`

- [x] ğŸ”´ `leave room` ìˆ˜ì‹ 

  - [x] ğŸ”´ í•´ë‹¹ `roomID`ì— ëŒ€í•œ `socket.leave` ì‹¤í–‰
  - [x] ğŸ”´ `roomStore`ì˜ í•´ë‹¹ `roomID` ì •ë³´ì—ì„œ `users`ì— í•´ë‹¹ ì´ë²¤íŠ¸ë¥¼ í˜¸ì¶œí•œ `socket.userID` ì œê±°
  - [x] ğŸ”´ ë³€ê²½ëœ `room` ì •ë³´ `roomStore`ì— ì €ì¥
  - [x] ğŸ”´ í‡´ì¥í•œ í´ë¼ì´ì–¸íŠ¸ ì •ë³´ ì •ë³´ `leave room` ì´ë²¤íŠ¸ë¡œ í´ë¼ì´ì–¸íŠ¸ì— ì „ë‹¬ ë°, í•´ë‹¹ `roomID`ì— í‡´ì¥ì•Œë¦¼ ì „ë‹¬

- [x] ğŸ”µ `leave room` ìˆ˜ì‹ 

  - [x] ğŸ”µ í‡´ì¥í•œ `userID`ê°€ ìì‹ ì˜ `socket.userID`ì™€ ë™ì¼í•˜ê³  `isJoined : true`ìƒíƒœë¼ë©´ `isJoined : false`ë¡œ ë³€ê²½
  - [x] ğŸ”µ í•´ë‹¹ `room`ì˜ ì†ì„±ê°’ë“¤ ëª¨ë‘ ì´ˆê¸°í™”`(messages, hasNewMessages ...)`
  - [x] ğŸ”µ `rooms` ìƒíƒœê°’ ë³€ê²½. ë§Œì•½, `isJoined : false`ë¡œ ë°”ë€ í´ë¼ì´ì–¸íŠ¸ë¼ë©´, `room-loby`ì»´í¬ë„ŒíŠ¸ ë¹„í™œì„±í™”

- [x] ğŸ”µ `roomID`ì™€ í•¨ê»˜`room`ì— ë©”ì‹œì§€ ì „ë‹¬

- [x] ğŸ”´ `room message` ìˆ˜ì‹ 

  - [x] ğŸ”´ í•´ë‹¹ `roomID`ì— ë©”ì‹œì§€ ë‚´ìš© ì „ë‹¬. ë°œì‹ ìëŠ” `socket.userID`

- [x] ğŸ”µ `room message` ìˆ˜ì‹ 
  - [x] ğŸ”µ í•´ë‹¹ `room`ì˜ `messages`ì— ì¶”ê°€
  - [x] ğŸ”µ í˜„ì¬ ì„ íƒëœ `room`ì´ ì•„ë‹ˆë¼ë©´, `hasNewMessages` ì¹´ìš´íŒ…

## ì¶”ê°€ ê³ ë¯¼ì‚¬í•­

- ìƒì„±ëœ roomì— ë‚¨ì•„ìˆëŠ” ì‚¬ìš©ìê°€ ì—†ë‹¤ë©´, room ì œê±°
- ì„ íƒì‚¬í•­
  - ì´ˆê¸° ìƒì„±í•œ ìœ ì €ì •ë³´ë¥¼ ë¡œì»¬ìŠ¤í† ë¦¬ì§€ì— ì €ì¥ ìœ ì§€ë¥¼ í†µí•´ `room`ì— `join`ëœ ìœ ì € ìœ ì§€(í…ŒìŠ¤íŠ¸í• ë• ì„¸ì…˜ìœ¼ë¡œ)
  - ëª¨ë“  ì»´í¬ë„ŒíŠ¸ê°€ ì–¸ë§ˆìš´íŠ¸(ë¸Œë¼ìš°ì € ì¢…ë£Œ)ë˜ì—ˆì„ ë•Œ, ëª¨ë“  `room`ì—ì„œ `leave` ì¡°ì¹˜ - ë˜ë„ë¡ ì´ë°©ë²•ì„ í•˜ëŠ”ê²Œ
